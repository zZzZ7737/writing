# 为什么要逻辑分层？及结合 react 的项目实践

### 为什么要逻辑分层?

<!--mvvm-->

一个可交互的前端项目由哪些东西构成？通常来说包括：数据、业务逻辑处理、视图。

在 react 为我们提供的组件化的开发方式中，我们可以把这三种逻辑全部在同一个组件中编写。但是从长远角度来考虑，我们并不想将处理这三种东西的代码都写在一起。

如果一个项目小到只有一个组件，那我们在这个组件里面处理所有东西就会让我们觉得很方便。我们在`componentDidMount`中请求完数据并进行处理，然后更新 state，执行渲染。当用户交互时，我们监听事件并处理交互数据，然后更新 state，执行渲染。很方便也很快捷。

但是如果项目变大了，有几个不同组件需要使用样的一份数据，有着类似的交互，那我们是不是还要在每个组件中都写一遍类似的逻辑呢？如果以后数据接口被修改了，或者交互逻辑改了，我们一个组件一个组件的修改时有没有一种想死的冲动呢？

所以我们思考怎么将这些重复的逻辑代码提取出来实现复用，

// TODO

<!--所以逻辑分层更多是一种代码组织的最佳实践。-->

### 使用 react 开发时我们如何拆分代码

react 组件中可以有什么？

1. react 组件是要渲染视图的，所以 render 函数必不可少
2. render 视图需要数据，其数据可以来自外部（props）或内部（state）
3. 当用户与视图交互时，我们需要监听交互事件并处理
4. 有些组件可能会有 io 异步操作
5. 样式，等等

react 为我们提供了组件化的开发方式。需要明确的是：**在 React 中，组件化是一种开发方式，并不一定是通用的逻辑封装**。

一个组件中可以包含这些东西，我们可以把所数据层、逻辑处理、视图层全部放到一个组件中去。但是我们真的需要把这些东西全部写进组件中去吗？这在非常小的项目中可能是一个非常快捷的方式，但是，就像上面说的，如果你这么写，当项目大了之后，整个代码将非常难以维护。所以通常我们考虑将数据层、业务逻辑处理全部抽离出来，仅仅把 react 组件当作一个交互式 UI 渲染工具。

react 并不擅长处理除了视图渲染之外的东西，所以 Facebook 提出了 flux 架构来帮助 react 项目去解决数据流及交互逻辑的东西。基于 flux 架构又出现了 redux 这样最受欢迎的 react 项目状态管理工具。又基于 react 的特性，出现了 react-redux 这个可以将 redux 与 react 更好链接在一起使用的工具。

现在我们基于 react、redux、react-redux 来分析在 react 项目中的逻辑分层的实践。

// TODO

// hooks 出现后，对这些有什么影响
