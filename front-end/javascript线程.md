---
tags: ['javascript', '基础知识']
createTime: '2018-10-30'
---
# javascript线程
最近虽然自己没有面试，但是为了提高自己，看了不少人的面试题，多多少少会提到事件循环（Event Loop）这个概念，于是，各种搜索学习。这就把自己的领悟的东西记一下，不一定都对，但也是代表现阶段的水平。
#### 为什么javascript要是单线程的
javascript在设计之初就是单线程的。考虑到js的用处：操作DOM、处理各种交互，如果js被设计成多线程，那么当一个线程删除了一个DOM节点，而另一个线程却正在使用这个节点，此时，要怎么处理呢？为了避免这种可能导致bug的复杂性问题，单线程无疑是很好的选择。
#### 什么是单线程？单线程存在的问题及解决方法
单线程，即程序执行时按照程序代码的排列顺序依次执行，后面的必须等到前面的执行完成后才能执行。如果前面的代码执行了很久，后面的代码就要一直等待。故而，单线程虽然简单，但效率却不高。所幸，在我们可以使用异步操作来提高效率。比如：在开发中常常需要进行数据请求操作，在发送请求后，如果一直等待接口返回数据后再进行操作，中间往往会有很长的空档期（io、网络延迟）。如果在这段时间什么都不做的话，用户体验会很不好。因此往往会使用异步请求。
#### 执行环境
单线程跟异步？有的人可能会想，这不是互相矛盾吗？事实上，javascript作为一个单线程执行的语言，确实不存在异步的说法，但是javascript的执行环境（浏览器、NodeJs）是多线程的啊。我们的一些I/O操作、定时器、事件监听等异步操作，都是执行环境通过其他线程来完成的。需要明白，*javascript的执行* 跟*javascript指令的实现* 是不同的概念，不同的执行环境有不同的实现。

>javascript中可以在函数代码未执行前就调用这个函数，是因为ECMAscript标准规定可以这么做，故而执行环境做了这个实现，而不是说javascript不是单线程。

在浏览器中，可以使用的异步操作指令或方法有`setInterval`、`setTimeout`、`Promise`、`postMessage`等。